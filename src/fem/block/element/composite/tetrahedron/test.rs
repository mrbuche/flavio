use crate::fem::block::
{
    element::composite::test::test_composite_element,
    test::test_finite_element_block
};
use super::*;

const D: usize = 35;
const E: usize = 12;

fn get_connectivity() -> Connectivity<E, N>
{
    [
        [26,  1,  3,  0, 27, 20, 28, 29, 13, 10],
        [26,  2,  3,  1, 30, 19, 28, 27,  9, 20],
        [26,  5,  4,  1, 31,  8, 32, 27, 22, 12],
        [26,  7,  4,  6, 33, 16, 32, 34, 18, 25],
        [26,  2,  1,  4, 30,  9, 27, 32, 23, 12],
        [26,  5,  1,  0, 31, 22, 27, 29, 11, 13],
        [26,  7,  2,  4, 33, 17, 30, 32, 16, 23],
        [26,  6,  0,  3, 34, 21, 29, 28, 14, 10],
        [26,  6,  5,  0, 34, 15, 31, 29, 21, 11],
        [26,  6,  4,  5, 34, 25, 32, 31, 15,  8],
        [ 3,  7,  2, 26, 24, 17, 19, 28, 33, 30],
        [ 3,  6,  7, 26, 14, 18, 24, 28, 34, 33]
    ]
}

fn get_coordinates_block() -> NodalCoordinates<D>
{
    NodalCoordinates::new([
        [0.5, -0.5, 0.5],
        [0.5, 0.5, 0.5],
        [-0.5, 0.5, 0.5],
        [-0.5, -0.5, 0.5],
        [0.5, 0.5, -0.5],
        [0.5, -0.5, -0.5],
        [-0.5, -0.5, -0.5],
        [-0.5, 0.5, -0.5],
        [0.5, 0.0, -0.5],
        [0.0, 0.5, 0.5],
        [0.0, -0.5, 0.5],
        [0.5, -0.5, 0.0],
        [0.5, 0.5, 0.0],
        [0.5, 0.0, 0.5],
        [-0.5, -0.5, 0.0],
        [0.0, -0.5, -0.5],
        [0.0, 0.5, -0.5],
        [-0.5, 0.5, 0.0],
        [-0.5, 0.0, -0.5],
        [-0.5, 0.0, 0.5],
        [0.0, 0.0, 0.5],
        [0.0, -0.5, 0.0],
        [0.5, 0.0, 0.0],
        [0.0, 0.5, 0.0],
        [-0.5, 0.0, 0.0],
        [0.0, 0.0, -0.5],
        [0.0, 0.0, 0.0],
        [0.25, 0.25, 0.25],
        [-0.25, -0.25, 0.25],
        [0.25, -0.25, 0.25],
        [-0.25, 0.25, 0.25],
        [0.25, -0.25, -0.25],
        [0.25, 0.25, -0.25],
        [-0.25, 0.25, -0.25],
        [-0.25, -0.25, -0.25]
    ])
}

fn get_reference_coordinates() -> ReferenceNodalCoordinates<N>
{
    ReferenceNodalCoordinates::new([
        [0.0, 0.0, 0.0],
        [1.0, 0.0, 0.0],
        [0.0, 1.0, 0.0],
        [0.0, 0.0, 1.0],
        [0.5, 0.0, 0.0],
        [0.5, 0.5, 0.0],
        [0.0, 0.0, 0.0],
        [0.0, 0.0, 0.5],
        [0.5, 0.0, 0.5],
        [0.0, 0.5, 0.5]
    ])
}

fn get_reference_coordinates_block() -> ReferenceNodalCoordinates<D>
{
    ReferenceNodalCoordinates::new([
        [0.5, -0.5, 0.5],
        [0.5, 0.5, 0.5],
        [-0.5, 0.5, 0.5],
        [-0.5, -0.5, 0.5],
        [0.5, 0.5, -0.5],
        [0.5, -0.5, -0.5],
        [-0.5, -0.5, -0.5],
        [-0.5, 0.5, -0.5],
        [0.5, 0.0, -0.5],
        [0.0, 0.5, 0.5],
        [0.0, -0.5, 0.5],
        [0.5, -0.5, 0.0],
        [0.5, 0.5, 0.0],
        [0.5, 0.0, 0.5],
        [-0.5, -0.5, 0.0],
        [0.0, -0.5, -0.5],
        [0.0, 0.5, -0.5],
        [-0.5, 0.5, 0.0],
        [-0.5, 0.0, -0.5],
        [-0.5, 0.0, 0.5],
        [0.0, 0.0, 0.5],
        [0.0, -0.5, 0.0],
        [0.5, 0.0, 0.0],
        [0.0, 0.5, 0.0],
        [-0.5, 0.0, 0.0],
        [0.0, 0.0, -0.5],
        [0.0, 0.0, 0.0],
        [0.25, 0.25, 0.25],
        [-0.25, -0.25, 0.25],
        [0.25, -0.25, 0.25],
        [-0.25, 0.25, 0.25],
        [0.25, -0.25, -0.25],
        [0.25, 0.25, -0.25],
        [-0.25, 0.25, -0.25],
        [-0.25, -0.25, -0.25]
    ])
}

fn get_velocities_block() -> NodalVelocities<D>
{
    NodalVelocities::new([
        [0.01645368, 0.05260200, 0.02408546],
        [0.05989263, 0.04132774, 0.04300265],
        [0.02602390, 0.02693895, 0.03945940],
        [0.07440375, 0.00484496, 0.05874542],
        [0.02820279, 0.01870134, 0.09465933],
        [0.03318801, 0.07025479, 0.09383862],
        [0.08623883, 0.09844547, 0.05975890],
        [0.06952362, 0.04190933, 0.05150422],
        [0.09431730, 0.02404220, 0.09812329],
        [0.05910890, 0.00860090, 0.07284891],
        [0.02482251, 0.02342835, 0.07593004],
        [0.07038800, 0.01474768, 0.06413451],
        [0.07406117, 0.02935939, 0.06263831],
        [0.04711463, 0.04249641, 0.05325871],
        [0.01486861, 0.02546480, 0.07316282],
        [0.00839487, 0.02109609, 0.07796772],
        [0.07043966, 0.09360524, 0.00796862],
        [0.09909761, 0.08710223, 0.07658513],
        [0.00902277, 0.07974163, 0.04240368],
        [0.03773506, 0.00388103, 0.04298711],
        [0.09130318, 0.06263284, 0.09173384],
        [0.00583300, 0.09219982, 0.05370069],
        [0.09592706, 0.01306129, 0.09007265],
        [0.02970818, 0.06952542, 0.06396818],
        [0.09559561, 0.04486288, 0.06636934],
        [0.05956468, 0.01787264, 0.07422170],
        [0.01386674, 0.04029826, 0.05606451],
        [0.05168296, 0.09973437, 0.05587671],
        [0.02266525, 0.09297348, 0.01079638],
        [0.05972763, 0.07918433, 0.06572725],
        [0.07916355, 0.04454104, 0.04270171],
        [0.08469643, 0.01393464, 0.01487269],
        [0.08905577, 0.03629476, 0.03149722],
        [0.07862019, 0.00210583, 0.00764262],
        [0.08332993, 0.09667342, 0.07310605]
    ])
}

test_composite_element!(Tetrahedron);
test_finite_element_block!(Tetrahedron);